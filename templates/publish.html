<!DOCTYPE html>
<html>
<head>
</head>
<body>

<!--<form id="form" action="" method="post">-->
<!--Name: <input type="text" name="name"><br>-->
<!--Age: <input type="text" name="email"><br>-->
<!--FavColor: <input type="text" name="favc"><br>-->
<!--<input id="submit" type="button" name="submit" value="submit">-->
<!--</form>-->

    <form id="myform">
        Text: <input type="text" id="text" name="text" value="enter text here" class="textboxclass"/><br>
        Email: <input id="email" name="email" /><br>
        Expiration Time (min)<input id="expiration_time_min" name="expiration_time_min" /><br>
        Self Destruct Count<input id="self_destruct_count" name="self_destruct_count" /><br>
        Password <input id="password" name="password" type="password"><br>
        <input id="submit" type="button" name="submit" value="submit"><br>
    </form>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
    // $(document).ready(function(){
    //     // click on button submit
    //     $("#submit").on('click', function(){
    //         // send ajax
    //         $.ajax({
    //             url: '/publish', // url where to submit the request
    //             type : "POST", // type of action POST || GET
    //             data : $("#form").serialize(), // post data || get data
    //             success : function(result) {
    //                 // you can see the result from the console
    //                 // tab of the developer tools
    //                 console.log(result);
    //             },
    //             error: function(xhr, resp, text) {
    //                 console.log(xhr, resp, text);
    //             }
    //         })
    //     });
    // });
    
    $(document).ready(function(){
        console.log("ready");
        $('#submit').on('click', function() {
             var data = {
                 text: $("#text").val(),
                 email: $("#email").val(),
                 expiration_time: $("#expiration_time_min").val(),
                 self_destruct_count: $("#self_destruct_count").val(),
                 password: $("#password").val()
             };
             
            $.ajax({
                url: "/publish",
                type: "POST",
                data: JSON.stringify(data),
                dataType: "json",
                contentType: "application/json",
      
            }).done(function(rdata){
                console.log(rdata.id);
                console.log("test");
                $(location).attr('href', 'https://nw-hackathon-mtlevine0.c9users.io/' + rdata.id)

            }).fail(function(error){
              console.log("test fail");  
            });
        });
    });
</script>
</body>
</html>